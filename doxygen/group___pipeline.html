<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>bref: Pipeline</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">bref
   
   </div>
   <div id="projectbrief">API 2014 of the Zia HTTP server.</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a>  </div>
  <div class="headertitle">
<div class="title">Pipeline</div>  </div>
</div><!--header-->
<div class="contents">

<p>The pipeline contains all the hooks points available for the bref API.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group___gate"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___gate.html">Gate</a></td></tr>
<tr class="memdesc:group___gate"><td class="mdescLeft">&#160;</td><td class="mdescRight"><p>Connections, data reception and sending events handling. </p>
<br/></td></tr>
<tr class="memitem:group___upstream"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___upstream.html">Upstream</a></td></tr>
<tr class="memdesc:group___upstream"><td class="mdescLeft">&#160;</td><td class="mdescRight"><p>Represents the pre-processing of a request. </p>
<br/></td></tr>
<tr class="memitem:group___bridge"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___bridge.html">Bridge</a></td></tr>
<tr class="memdesc:group___bridge"><td class="mdescLeft">&#160;</td><td class="mdescRight"><p>Contains hooks to run for content generation. </p>
<br/></td></tr>
<tr class="memitem:group___downstream"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___downstream.html">Downstream</a></td></tr>
<tr class="memdesc:group___downstream"><td class="mdescLeft">&#160;</td><td class="mdescRight"><p>Handle all stages between the content generation and sending data back to the client. </p>
<br/></td></tr>
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbref_1_1_environment.html">bref::Environment</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This structure defines the environment of a request.  <a href="structbref_1_1_environment.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbref_1_1_pipeline.html">bref::Pipeline</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Where the IModule classes register their hooks.  <a href="structbref_1_1_pipeline.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga9af254d2f49ba7e77095265d6dd5566b"><td class="memItemLeft" align="right" valign="top">typedef BrefValue&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___pipeline.html#ga9af254d2f49ba7e77095265d6dd5566b">bref::ServerConfig</a></td></tr>
<tr class="memdesc:ga9af254d2f49ba7e77095265d6dd5566b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The value used for the configuration settings of the server.  <a href="#ga9af254d2f49ba7e77095265d6dd5566b"></a><br/></td></tr>
<tr class="memitem:ga977c07056bf73e57be0393266de75f5a"><td class="memItemLeft" align="right" valign="top">typedef int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___pipeline.html#ga977c07056bf73e57be0393266de75f5a">bref::FdType</a></td></tr>
<tr class="memdesc:ga977c07056bf73e57be0393266de75f5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define fd type (system dependant : fd on UNIX systems, HANDLE for Windows systems) for ContentHook.  <a href="#ga977c07056bf73e57be0393266de75f5a"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<p>The pipeline contains all the hooks points available for the bref API. </p>
<p>When a module is initialized by the method <code>IModule::registerHooks(Pipeline &amp;)</code> it initializes its hook points in the <a class="el" href="structbref_1_1_pipeline.html" title="Where the IModule classes register their hooks.">Pipeline</a>.</p>
<p>This page describes how the <a class="el" href="structbref_1_1_pipeline.html" title="Where the IModule classes register their hooks.">Pipeline</a> class works and how it interacts with the different hook points.</p>
<p>Vocabulary:</p>
<ul>
<li><p class="startli"><em>Hook:</em> </p>
<p class="startli">Hooks are RequestHandlers (see below) generators for a given set of arguments. If -- given the argument(s) it received -- a hook decides not to handle a request, a null handler is generated.</p>
<p class="startli">Examples of hooks are: <a class="el" href="group___upstream.html#gaf6436193fb29c8d894fdab7246050e97" title="Generate a Pipeline::PostParsingRequestHandler.">Pipeline::PostParsingHook</a>, <a class="el" href="group___gate.html#ga1f2f6bb4cfebbdd10566d3aa85fce82d" title="Generate a Pipeline::OnReceiveRequestHandler.">Pipeline::OnReceiveHook</a>, ...</p>
<p class="startli">In term of code, a hook is a <a class="el" href="classbref_1_1_function.html" title="Polymorphic Function Object Wrapper.">Function</a> object that returns another <a class="el" href="classbref_1_1_function.html" title="Polymorphic Function Object Wrapper.">Function</a> object. It's often constructed with an <a class="el" href="structbref_1_1_environment.html" title="This structure defines the environment of a request.">Environment</a> and an <a class="el" href="classbref_1_1_http_request.html" title="HTTP request container.">HttpRequest</a>.</p>
</li>
</ul>
<ul>
<li><p class="startli"><em>RequestHandler:</em> </p>
<p class="startli">A request handler (e.g: <a class="el" href="group___gate.html#gadbb39dc7b9243db92971de9c901d92b3" title="A hook for the connection of a client.">Pipeline::ConnectionRequestHandler</a>, <a class="el" href="group___gate.html#ga3e600a7888ca0a742399d6fd07eacd04" title="The handler to call when there is pending data on a socket.">Pipeline::OnReceiveRequestHandler</a>) is the function object, returned by the hook, that will handle a request. It should be called with the arguments provided by its corresponding hook point (e.g.: the <a class="el" href="group___gate.html#gadbb39dc7b9243db92971de9c901d92b3" title="A hook for the connection of a client.">Pipeline::ConnectionRequestHandler</a> takes an <a class="el" href="classbref_1_1_http_response.html" title="HTTP response container.">HttpResponse</a> and an <a class="el" href="classbref_1_1_ip_address.html" title="Provides IPv4 &amp; Ipv6 encapsulation.">IpAddress</a>).</p>
<p class="startli">The majority of the request handlers takes an <a class="el" href="classbref_1_1_http_response.html" title="HTTP response container.">HttpResponse</a> as reference, they can fill its header. When a response is finished, the upstream or bridge elements of the pipeline will directly go to the downstream part.</p>
</li>
</ul>
<ul>
<li><p class="startli"><em>Priority</em> </p>
<p class="startli">Used to represent the precedence of one request handler over another, when placed on the same hook point. Depending on the hook point, either all the request handlers will be called, starting with the highest priority, or only the most important one will be called.</p>
<p class="startli">The priority is a floating number between 0.0 and 1.0. Modules should try to follow the following convention (but the value can be adapted):</p>
<ul>
<li>Low Priority: 0.0</li>
<li>Normal Priority: 0.5</li>
<li>High Priority: 1.0</li>
</ul>
</li>
</ul>
<p>Example for a CGI module:</p>
<ol type="1">
<li>Register a <a class="el" href="group___bridge.html#ga1aa84a42ed90b588f4abd2e2456ed766" title="Generate Pipeline::ContentRequestHandler.">Pipeline::ContentHook</a> with a high priority (1.0) that returns a valid Pipeline::ContentRequestHandler if it detects a request asking a PHP file (by checking the .php extension for example and some configuration variables), otherwise it should return an empty handler.</li>
</ol>
<ol type="1">
<li>Create the Pipeline::ContentRequestHandler that creates a process when it's constructed, and has a function operator() that takes each chunk of the request body and send them to the CGI process, and fill a buffer in return. </li>
</ol>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="ga977c07056bf73e57be0393266de75f5a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int <a class="el" href="group___pipeline.html#ga977c07056bf73e57be0393266de75f5a">bref::FdType</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Define fd type (system dependant : fd on UNIX systems, HANDLE for Windows systems) for ContentHook. </p>
<dl class="section see"><dt>See also:</dt><dd>ContentHook </dd></dl>

</div>
</div>
<a class="anchor" id="ga9af254d2f49ba7e77095265d6dd5566b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef BrefValue <a class="el" href="group___pipeline.html#ga9af254d2f49ba7e77095265d6dd5566b">bref::ServerConfig</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The value used for the configuration settings of the server. </p>
<p>A typedef is used here for a better readability. </p>

</div>
</div>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 3 2012 22:14:54 for bref by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.0
</small></address>

</body>
</html>
